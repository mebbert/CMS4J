# CMS4J
A user-friendly version of the composite of multiple signals (CMS) implemented in Java

## How to run CMS4J





##Output for a functioning program when running (test data/clean data) will look like this:

```
======================================================Round 1======================================================================
Starting iHS Analysis
Starting XPEHH Analysis
XPEHH =	SNP [pos=10873592, snp_id=rs1395681, a0=G, a1=A]	0.08569249440858209	1.0000000000000002
XPEHH =	SNP [pos=10881456, snp_id=rs28578587, a0=T, a1=C]	0.03678113363681471	-0.9999999999999999
Starting iHH Analysis
Starting DAF Analysis
Starting Fst Analysis
FST =	SNP [pos=10873592, snp_id=rs1395681, a0=G, a1=A]	1.2958851674641148
FST =	SNP [pos=10881456, snp_id=rs28578587, a0=T, a1=C]	1.4152276295133437

======================================================Round 2======================================================================
					    Last 7 lines of every stat

Starting iHS Analysis
iHS =	SNP [pos=14775085, snp_id=rs2747265, a0=C, a1=G]	-0.589677998473116	-0.7696535419209273
iHS =	SNP [pos=14781959, snp_id=rs446549, a0=A, a1=G]	-1.0223001972313361	-1.6838548658693318
iHS =	SNP [pos=14785028, snp_id=rs431133, a0=G, a1=A]	0.5864846531018965	1.7157701287434333
iHS =	SNP [pos=14818410, snp_id=rs2821870, a0=T, a1=C]	-0.6195014088871154	-0.832675276273427
iHS =	SNP [pos=14880003, snp_id=rs13047108, a0=A, a1=C]	-0.36601228485709697	-0.2970113795525913
iHS =	SNP [pos=14931069, snp_id=rs117062102, a0=C, a1=G]	0.44781812890226097	1.4227451282360557
iHS =	SNP [pos=14936462, snp_id=kgp7953532, a0=T, a1=C]	-0.36929558509399946	-0.30394952889423865

Starting XPEHH Analysis
XPEHH =	SNP [pos=14781959, snp_id=rs446549, a0=G, a1=A]	0.5960972460390418	0.4468217926498264
XPEHH =	SNP [pos=14785028, snp_id=rs431133, a0=G, a1=A]	0.48817009107917	-0.16575103502349156
XPEHH =	SNP [pos=14818410, snp_id=rs2821870, a0=T, a1=C]	0.49033471249680066	-0.1534650791569326
XPEHH =	SNP [pos=14880003, snp_id=rs13047108, a0=A, a1=C]	0.15168895148024325	-2.07555031787767
XPEHH =	SNP [pos=14882965, snp_id=rs144165180, a0=G, a1=A]	0.3203370574038753	-1.118337583364287
XPEHH =	SNP [pos=14931069, snp_id=rs117062102, a0=C, a1=G]	0.8049826912274676	1.63241357320264
XPEHH =	SNP [pos=14936462, snp_id=rs150120078, a0=T, a1=C]	0.6633234300972322	0.8283840943478931

Starting iHH Analysis
iHH =	SNP [pos=14775085, snp_id=rs2747265, a0=C, a1=G]	1339253.4002507138	0.38121299881004816
iHH =	SNP [pos=14781959, snp_id=rs446549, a0=A, a1=G]	2840086.577047873	2.662195152650273
iHH =	SNP [pos=14785028, snp_id=rs431133, a0=G, a1=A]	1327110.938517952	0.36275875689675086
iHH =	SNP [pos=14818410, snp_id=rs2821870, a0=T, a1=C]	844465.1976076569	-0.37077135068839495
iHH =	SNP [pos=14880003, snp_id=rs13047108, a0=A, a1=C]	1355246.1671102513	0.4055189752244159
iHH =	SNP [pos=14931069, snp_id=rs117062102, a0=C, a1=G]	983494.2243573167	-0.1594735637094967
iHH =	SNP [pos=14936462, snp_id=kgp7953532, a0=T, a1=C]	1071699.7875737464	-0.025417814758463306

Starting DAF Analysis
DAF =	SNP [pos=14781959, snp_id=rs446549, a0=A, a1=G]	0.5	-0.14
DAF =	SNP [pos=14785028, snp_id=rs431133, a0=G, a1=A]	0.92	0.019999999999999907
DAF =	SNP [pos=14818410, snp_id=rs2821870, a0=T, a1=C]	0.9	-0.09999999999999998
DAF =	SNP [pos=14880003, snp_id=rs13047108, a0=A, a1=C]	0.32	0.020000000000000018
DAF =	SNP [pos=14882965, snp_id=rs144165180, a0=G, a1=A]	0.0	0.04
DAF =	SNP [pos=14931069, snp_id=rs117062102, a0=C, a1=G]	0.1	-0.04000000000000001
DAF =	SNP [pos=14936462, snp_id=kgp7953532, a0=T, a1=C]	0.06	0.0

Starting Fst Analysis
FST =	SNP [pos=14781959, snp_id=rs446549, a0=G, a1=A]	0.2939536878216123
FST =	SNP [pos=14785028, snp_id=rs431133, a0=G, a1=A]	1.014324960753532
FST =	SNP [pos=14818410, snp_id=rs2821870, a0=T, a1=C]	0.11111111111111108
FST =	SNP [pos=14880003, snp_id=rs13047108, a0=A, a1=C]	0.18454088952654235
FST =	SNP [pos=14882965, snp_id=rs144165180, a0=G, a1=A]	0.04054054054054069
FST =	SNP [pos=14931069, snp_id=rs117062102, a0=C, a1=G]	0.01499999999999997
FST =	SNP [pos=14936462, snp_id=rs150120078, a0=T, a1=C]	0.7202380952380951

======================================================Round 3======================================================================
                                            Last 5 lines of every stat

Starting iHS Analysis
iHS =	SNP [pos=15481365, snp_id=rs7278737, a0=T, a1=G]	-0.7069257543565668	0.20818264782724735
iHS =	SNP [pos=15482605, snp_id=rs1556276, a0=A, a1=G]	-1.8037272191521176	-0.7553394058038247
iHS =	SNP [pos=15491560, snp_id=rs2403729, a0=G, a1=A]	-0.9169210590929179	0.023705225279158363
iHS =	SNP [pos=15493361, snp_id=rs2155971, a0=G, a1=A]	-1.534343807158523	-0.5186905074668807
iHS =	SNP [pos=15494781, snp_id=rs11701216, a0=T, a1=C]	-1.4606836789320814	-0.45398129591171676
iHS =	SNP [pos=15494955, snp_id=rs2032283, a0=C, a1=T]	-0.8606144869173765	0.07316962316416369
iHS =	SNP [pos=15495000, snp_id=rs2032284, a0=G, a1=A]	-2.2655568537089543	-1.1610491465351045

Starting XPEHH Analysis
XPEHH =	SNP [pos=15420732, snp_id=rs4816917, a0=A, a1=G]	0.5940866105044201	0.769131124567219
XPEHH =	SNP [pos=15423382, snp_id=rs34848403, a0=A, a1=G]	0.5942886592310366	0.770364461400953
XPEHH =	SNP [pos=15423628, snp_id=rs9983190, a0=G, a1=T]	0.5942586057296559	0.7701810101570075
XPEHH =	SNP [pos=15423737, snp_id=rs2000701, a0=T, a1=C]	0.5942939011556	0.7703964589232932
XPEHH =	SNP [pos=15424368, snp_id=rs2155965, a0=A, a1=T]	0.5941557260272059	0.7695530164616248
XPEHH =	SNP [pos=15430004, snp_id=rs13046630, a0=G, a1=A]	0.5928951771988107	0.7618584304733079
XPEHH =	SNP [pos=15435740, snp_id=rs117422362, a0=C, a1=T]	0.5926693530561743	0.7604799648045358

Starting iHH Analysis
iHH =	SNP [pos=15481365, snp_id=rs7278737, a0=T, a1=G]	246288.07000997217	-0.8033481776864776
iHH =	SNP [pos=15482605, snp_id=rs1556276, a0=A, a1=G]	958453.1326957411	0.07164600476779973
iHH =	SNP [pos=15491560, snp_id=rs2403729, a0=G, a1=A]	267644.2342478619	-0.777109149058452
iHH =	SNP [pos=15493361, snp_id=rs2155971, a0=G, a1=A]	578952.2145706662	-0.39462384332500694
iHH =	SNP [pos=15494781, snp_id=rs11701216, a0=T, a1=C]	580826.3380396814	-0.39232122105594325
iHH =	SNP [pos=15494955, snp_id=rs2032283, a0=C, a1=T]	258279.17220160188	-0.7886154349437742
iHH =	SNP [pos=15495000, snp_id=rs2032284, a0=G, a1=A]	1329801.3930938174	0.5278991749070961

Starting DAF Analysis
DAF =	SNP [pos=15417667, snp_id=rs7276301, a0=C, a1=T]	0.1	0.16
DAF =	SNP [pos=15417795, snp_id=rs7275446, a0=G, a1=A]	0.32	-0.16
DAF =	SNP [pos=15423382, snp_id=rs34848403, a0=A, a1=G]	0.2	0.03999999999999998
DAF =	SNP [pos=15423628, snp_id=rs9983190, a0=G, a1=T]	0.38	-0.09999999999999998
DAF =	SNP [pos=15424368, snp_id=rs2155965, a0=A, a1=T]	0.2	0.0
DAF =	SNP [pos=15430004, snp_id=rs13046630, a0=G, a1=A]	0.2	-0.06
DAF =	SNP [pos=15435740, snp_id=rs117422362, a0=C, a1=T]	0.12	-0.06

Starting Fst Analysis
Fst =	SNP [pos=15420732, snp_id=rs4816917, a0=A, a1=G]	0.39329903889676315
Fst =	SNP [pos=15423382, snp_id=rs34848403, a0=A, a1=G]	0.0036204958173745665
Fst =	SNP [pos=15423628, snp_id=rs9983190, a0=G, a1=T]	0.1951530612244899
Fst =	SNP [pos=15423737, snp_id=rs2000701, a0=T, a1=C]	0.7258668872954587
Fst =	SNP [pos=15424368, snp_id=rs2155965, a0=A, a1=T]	0.09542705971277399
Fst =	SNP [pos=15430004, snp_id=rs13046630, a0=G, a1=A]	-0.007878286449715029
Fst =	SNP [pos=15435740, snp_id=rs117422362, a0=C, a1=T]	0.047831632653061174
```

You can do a 4th round on a much larger Window size but if these are working and that round runs
all the way through I would expect it to be correct as well

### SetOperator (SO)
SetOperator will perform intersects, unions, and complements on multi- or
single-sample VCFs while considering sample genotypes. 
Some important features for SetOperator are:

* Handles multi-sample VCFs
* Genotype aware set operations (e.g., only intersect on hets)
* Powerful set operation syntax
* Operation stringing (predefine operations whose result should be passed
  directly to the next operation
* Auto 'chr' handling (i.e., we don't care if some VCFs have 'chr' preprended to
  the #CHROM value and some don't.)
* INDEL fuzzy matching (sometimes INDELS don't align the same even though they
  are the same). We'll tell you about these matches.


